<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKay Thai Bot - AI Concierge</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Lexend:wght@400;600&family=Pacifico&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-main: 'Poppins', sans-serif;
            --font-fancy: 'Pacifico', cursive;
            --font-bold: 'Montserrat', sans-serif;
            --border-radius: 16px;
        }

        /* --- THEME: Celestial Aura (Default) --- */
        body.theme-default {
            --bg-gradient: linear-gradient(160deg, #19162c 0%, #3c2f5f 100%);
            --bg-chat-window: rgba(25, 22, 44, 0.85);
            --border-glow: rgba(255, 221, 51, 0.35); /* yellow glow */
            --accent-glow: #ffe066; /* yellow accent */
            --accent-secondary: #fff200; /* strong yellow */
            --text-primary: #fffbe6; /* soft yellowish white */
            --text-secondary: #ffe066;
            --user-bubble-bg: linear-gradient(145deg, #ffe066 60%, #fff200 100%);
            --ai-bubble-bg: #2a2540;
            --button-bg: linear-gradient(90deg, #ffe066 60%, #fff200 100%);
            --button-hover-bg: linear-gradient(90deg, #fff200 60%, #ffe066 100%);
        }
        body.theme-default .header-title h1 {
            font-family: var(--font-fancy);
            font-size: 2.2rem;
            color: var(--accent-secondary);
            text-shadow: 0 0 18px var(--accent-glow), 0 2px 8px #fff200;
            letter-spacing: 2px;
            animation: floatTitle 2.5s infinite ease-in-out;
        }
        @keyframes floatTitle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }
        body.theme-default .header-title p {
            color: var(--accent-glow);
            font-family: var(--font-bold);
            font-size: 1.05rem;
            letter-spacing: 1px;
        }
        body.theme-default .action-button {
            font-family: var(--font-bold);
            background: var(--button-bg);
            color: #19162c;
            border: 2px solid var(--accent-secondary);
            box-shadow: 0 0 12px var(--accent-glow), 0 2px 8px #fff200;
            font-size: 1.1rem;
            transition: all 0.25s cubic-bezier(.68,-0.55,.27,1.55), box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }
        body.theme-default .action-button:hover {
            background: var(--button-hover-bg);
            color: #19162c;
            box-shadow: 0 0 24px var(--accent-secondary), 0 4px 16px #ffe066;
            transform: translateY(-3px) scale(1.07) rotate(-2deg);
            text-shadow: 0 0 8px #fff200;
        }
        body.theme-default .action-button:active {
            transform: scale(0.97);
            box-shadow: 0 0 8px var(--accent-secondary);
        }
        body.theme-default .avatar {
            background: var(--accent-secondary);
            color: #19162c;
            box-shadow: 0 0 16px var(--accent-glow), 0 2px 8px #fff200;
            font-size: 2rem;
            font-family: var(--font-fancy);
            border: 2px solid #ffe066;
        }
        body.theme-default .ai .avatar {
            background: #ffe066;
            color: #19162c;
            box-shadow: 0 0 16px #fff200;
        }
        body.theme-default .user .avatar {
            background: #fff200;
            color: #19162c;
            box-shadow: 0 0 16px #ffe066;
        }
        body.theme-default .message-content {
            font-family: var(--font-main);
            font-size: 1.08rem;
            color: var(--text-primary);
            background: var(--ai-bubble-bg);
            border: 2px solid var(--accent-glow);
            box-shadow: 0 0 10px var(--accent-glow);
            transition: box-shadow 0.2s;
        }
        body.theme-default .user .message-content {
            background: var(--user-bubble-bg);
            color: #19162c;
            font-family: var(--font-bold);
            box-shadow: 0 0 18px #fff200;
        }
        body.theme-default .chat-message {
            animation: slideIn 0.7s cubic-bezier(.68,-0.55,.27,1.55);
        }
        body.theme-default .card {
            background: linear-gradient(135deg, #fffbe6 80%, #ffe066 100%);
            border: 2px solid #ffe066;
            color: #19162c;
            font-family: var(--font-main);
            box-shadow: 0 0 18px #ffe066;
        }
        body.theme-default .card h3 {
            font-family: var(--font-fancy);
            color: #fff200;
            text-shadow: 0 0 8px #ffe066;
            font-size: 1.3rem;
        }
        body.theme-default .card strong {
            color: #19162c;
            font-family: var(--font-bold);
        }
        body.theme-default .settings-btn {
            color: #fff200;
            text-shadow: 0 0 8px #ffe066;
            font-size: 2.2rem;
            transition: transform 0.2s, color 0.2s;
        }
        body.theme-default .settings-btn:hover {
            color: #ffe066;
            transform: scale(1.15) rotate(-8deg);
        }
        body.theme-default #chat-log::-webkit-scrollbar-thumb {
            background: #ffe066;
        }
        body.theme-default #chat-log::-webkit-scrollbar-thumb:hover {
            background: #fff200;
        }
        body.theme-default .option-btn {
            background: var(--button-bg);
            color: #19162c;
            border: 2px solid #ffe066;
            font-family: var(--font-bold);
            font-size: 1rem;
            box-shadow: 0 0 8px #ffe066;
            transition: all 0.2s;
        }
        body.theme-default .option-btn.active {
            background: #fff200;
            color: #19162c;
            box-shadow: 0 0 16px #ffe066;
        }
        body.theme-default .option-btn:hover {
            background: #ffe066;
            color: #19162c;
            transform: scale(1.08);
        }
        body.theme-default #freeform-input {
            background: #fffbe6;
            color: #19162c;
            border: 2px solid #ffe066;
            font-family: var(--font-main);
            font-size: 1.08rem;
        }
        body.theme-default #freeform-input:focus {
            border-color: #fff200;
            box-shadow: 0 0 8px #ffe066;
        }

        /* --- THEME: High Contrast (Color-Blind Friendly) --- */
        body.theme-high-contrast {
            --bg-gradient: linear-gradient(160deg, #e0e0e0 0%, #ffffff 100%);
            --bg-chat-window: #f5f5f5;
            --border-glow: #cccccc;
            --accent-glow: #000000;
            --accent-secondary: #ffc107;
            --text-primary: #000000;
            --text-secondary: #555555;
            --user-bubble-bg: #ffc107;
            --ai-bubble-bg: #e0e0e0;
            --button-bg: #e0e0e0;
            --button-hover-bg: #d1d1d1;
        }
        body.theme-high-contrast .user .message-content, body.theme-high-contrast .user .avatar { color: #000; }
        body.theme-high-contrast .ai .avatar { background: #000; color: #fff; }

        /* --- THEME: Low Sensory (Autism-Friendly) --- */
        body.theme-low-sensory {
            --font-main: 'Lexend', sans-serif; /* High legibility font */
            --bg-gradient: linear-gradient(160deg, #d3e0ea 0%, #e9f0f5 100%);
            --bg-chat-window: #f8f9fa;
            --border-glow: #d3d3d3;
            --accent-glow: #5c677d;
            --accent-secondary: #8791a3;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --user-bubble-bg: #d3e0ea;
            --ai-bubble-bg: #e9ecef;
            --button-bg: #e9ecef;
            --button-hover-bg: #d3e0ea;
        }
        body.theme-low-sensory .ai .avatar { background: var(--accent-glow); color: #fff; }
        body.theme-low-sensory .user .avatar { background: var(--accent-secondary); color: #fff; }
        body.theme-low-sensory .star { display: none !important; } /* Hide stars */
        body.theme-low-sensory .chat-message { animation: none; } /* No animations */

        /* --- THEME: Pride (LGBTQ+ Friendly) --- */
        body.theme-pride {
            --bg-gradient: linear-gradient(160deg, #1e1e1e 0%, #3e3e3e 100%);
            --bg-chat-window: rgba(25, 22, 44, 0.85);
            --border-glow: rgba(255, 255, 255, 0.2);
            --accent-glow: #ffffff;
            --accent-secondary: #ffc400;
            --text-primary: #f0f0f5;
            --text-secondary: #a7a1c4;
            --user-bubble-bg: linear-gradient(145deg, #6c56c2, #4c3d8f);
            --ai-bubble-bg: #2a2540;
            --button-bg: linear-gradient(90deg, #E40303, #FF8C00, #FFED00, #008026, #004DFF, #750787);
            --button-hover-bg: linear-gradient(90deg, #E40303, #FF8C00, #FFED00, #008026, #004DFF, #750787);
        }
        body.theme-pride .action-button { color: white; border: none; opacity: 0.8; }
        body.theme-pride .action-button:hover { opacity: 1; }
        body.theme-pride .header-title h1 { text-shadow: 0 0 10px #fff; }
        body.theme-pride .ai .avatar { background: linear-gradient(45deg, #E40303, #FF8C00, #FFED00, #008026, #004DFF, #750787); color: white; }

        /* --- BASE STYLES --- */
        body {
            font-family: var(--font-main);
            margin: 0;
            padding: 0;
            background: var(--bg-gradient);
            color: var(--text-primary);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        #star-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
            background: transparent; overflow: hidden;
        }
        .star {
            position: absolute; background-color: white; border-radius: 50%;
            animation: twinkle linear infinite;
        }
        @keyframes twinkle { 0%, 100% { opacity: 0; } 50% { opacity: 1; } }

        .container {
            width: 100%; height: 100%; max-width: 800px; max-height: 90vh;
            display: flex; flex-direction: column; background: var(--bg-chat-window);
            backdrop-filter: blur(10px); border-radius: var(--border-radius);
            box-shadow: 0 0 40px var(--border-glow); border: 1px solid var(--border-glow); z-index: 1;
        }

        .chat-header {
            padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-glow);
            text-align: center; background: rgba(0,0,0,0.2);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            display: flex; justify-content: space-between; align-items: center;
        }
        
        .settings-btn {
            background: none; border: none; font-size: 1.8rem; cursor: pointer;
            opacity: 0.8; transition: opacity 0.2s, transform 0.2s; color: var(--text-primary);
        }
        .settings-btn:hover { opacity: 1; transform: scale(1.1); }

        .header-title h1 { margin: 0; font-size: 1.5rem; color: var(--text-primary); text-shadow: 0 0 10px var(--accent-glow); }
        .header-title p { margin: 5px 0 0; color: var(--text-secondary); font-size: 0.9rem; }

        #chat-log { flex-grow: 1; padding: 1.5rem; overflow-y: auto; display: flex; flex-direction: column; gap: 1rem; }
        .chat-message { display: flex; gap: 10px; max-width: 85%; animation: slideIn 0.4s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; flex-shrink: 0; }
        .ai .avatar { background: var(--accent-glow); color: #19162c; box-shadow: 0 0 10px var(--accent-glow); }
        .user .avatar { background: var(--accent-secondary); color: #19162c; box-shadow: 0 0 10px var(--accent-secondary); }

        .message-content { padding: 1rem; border-radius: var(--border-radius); position: relative; }
        .ai .message-content { background: var(--ai-bubble-bg); align-self: flex-start; }
        .user { align-self: flex-end; flex-direction: row-reverse; }
        .user .message-content { background: var(--user-bubble-bg); color: var(--text-primary); }

        #user-input-area { padding: 1.5rem; border-top: 1px solid var(--border-glow); display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .action-button {
            background: var(--button-bg); color: var(--text-primary); border: 1px solid var(--border-glow);
            padding: 10px 20px; border-radius: 20px; cursor: pointer; transition: all 0.2s ease;
        }
        .action-button:hover { background: var(--button-hover-bg); border-color: var(--accent-glow); transform: translateY(-2px); }

        .card { background: var(--ai-bubble-bg); border: 1px solid var(--border-glow); border-radius: var(--border-radius); padding: 1rem; margin-top: 10px; }
        .card h3 { margin-top: 0; color: var(--accent-glow); }
        .card p { margin: 5px 0; } .card strong { color: var(--text-primary); }

        #freeform-input-container { display: none; width: 100%; gap: 10px; }
        #freeform-input { flex-grow: 1; background: var(--ai-bubble-bg); border: 1px solid var(--border-glow); color: var(--text-primary); padding: 10px 15px; border-radius: 20px; }
        #freeform-input:focus { outline: none; border-color: var(--accent-glow); }

        #chat-log::-webkit-scrollbar { width: 8px; }
        #chat-log::-webkit-scrollbar-track { background: transparent; }
        #chat-log::-webkit-scrollbar-thumb { background: var(--accent-glow); border-radius: 4px; }
        #chat-log::-webkit-scrollbar-thumb:hover { background: #c9b4ff; }

        /* Settings Panel */
        .settings-panel {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); z-index: 100;
            justify-content: center; align-items: center;
        }
        .settings-content {
            background: var(--bg-chat-window); padding: 2rem; border-radius: var(--border-radius);
            border: 1px solid var(--border-glow); box-shadow: 0 0 50px rgba(0,0,0,0.5);
            width: 90%; max-width: 500px;
        }
        .settings-content h2 { margin-top: 0; color: var(--text-primary); }
        .settings-section { margin-bottom: 1.5rem; }
        .settings-section h3 { margin-bottom: 1rem; color: var(--text-secondary); }
        .settings-options { display: flex; flex-wrap: wrap; gap: 10px; }
        .option-btn {
            background: var(--button-bg); color: var(--text-primary); border: 1px solid var(--border-glow);
            padding: 8px 15px; border-radius: 10px; cursor: pointer; transition: all 0.2s ease;
        }
        .option-btn.active { background: var(--accent-glow); color: #000; }
        .close-settings-btn { width: 100%; margin-top: 1rem; }
    </style>
</head>
<body>
    <div id="star-background"></div>
    <div class="container">
        <div class="chat-header">
            <button class="settings-btn" id="langBtn" title="Language">🌐</button>
            <div class="header-title">
                <h1>OKay Thai Bot</h1>
                <p>Your AI Concierge for OKay Thai Language Center</p>
            </div>
            <button class="settings-btn" id="themeBtn" title="Theme">🎨</button>
        </div>
        <div id="chat-log"></div>
        <div id="user-input-area"></div>
    </div>

    <!-- Settings Panels -->
    <div id="language-panel" class="settings-panel">
        <div class="settings-content">
            <h2>Language</h2>
            <div class="settings-section">
                <div class="settings-options" id="language-options">
                    <button class="option-btn" data-lang="en">🇬🇧 English</button>
                    <button class="option-btn" data-lang="mm">🇲🇲 Myanmar</button>
                    <button class="option-btn" data-lang="th">🇹🇭 Thai</button>
                </div>
            </div>
            <button class="action-button close-settings-btn" id="closeLangBtn">Close</button>
        </div>
    </div>
    
    <div id="theme-panel" class="settings-panel">
        <div class="settings-content">
            <h2>Theme</h2>
            <div class="settings-section">
                <div class="settings-options" id="theme-options">
                    <button class="option-btn" data-theme="theme-default">✨ Celestial Aura</button>
                    <button class="option-btn" data-theme="theme-high-contrast">👁️ High Contrast</button>
                    <button class="option-btn" data-theme="theme-low-sensory">🧠 Low Sensory</button>
                    <button class="option-btn" data-theme="theme-pride">🌈 Pride</button>
                </div>
            </div>
            <button class="action-button close-settings-btn" id="closeThemeBtn">Close</button>
        </div>
    </div>

    <script>
        // --- UTILITY & SETUP ---
        const chatLog = document.getElementById('chat-log');
        const userInputArea = document.getElementById('user-input-area');
        const starBackground = document.getElementById('star-background');
        let conversationState = {};
        let currentLanguage = 'en';
        let currentTheme = 'theme-default';

        function loadFromStorage(key, fallback = null) {
            const stored = localStorage.getItem(key);
            return stored ? JSON.parse(stored) : fallback;
        }

        function saveToStorage(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }
        
        function createStars() {
            const numStars = 100;
            starBackground.innerHTML = ''; // Clear existing stars
            for (let i = 0; i < numStars; i++) {
                let star = document.createElement('div');
                star.className = 'star';
                let size = Math.random() * 2 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.animationDuration = `${Math.random() * 3 + 2}s`;
                star.style.animationDelay = `${Math.random() * 2}s`;
                starBackground.appendChild(star);
            }
        }

        // --- TRANSLATION DATA ---
        const translations = {
            en: { welcome: 'สวัสดีค่ะ (Sawasdee ka!) Welcome! I am your AI Concierge for the OKay Thai Language Center. How can I help you today?', findCourse: 'Find a Course for Me', askQuestion: 'Ask a Question', meetLecturers: 'Meet the Lecturers', goBack: 'Go Back', coursePrompt: 'I can definitely help with that! To recommend the perfect course, could you tell me what type of class you\'re interested in?', levelPrompt: (type) => `Great choice! For the ${type}, which level are you interested in?`, courseResultHeader: 'Your Recommended Course', enrollPrompt: 'I can guide you through enrollment for this course, or we can explore other options. What would you like to do?', enrollNow: 'Enroll Now! ✨', exploreOther: 'Explore Other Courses', mainMenu: 'Main Menu', enrollSoon: 'This full enrollment feature is coming soon. For now, our staff will contact you via Facebook Messenger to complete your registration. Thank you!', startOver: 'Start Over', faqPrompt: 'I have answers to many common questions. Which of these topics can I help you with?', faqFollowUp: 'Can I help with another topic?', seeOtherQuestions: 'See Other Questions', lecturerIntro: 'Here are some of our highly qualified and experienced lecturers:', lecturerFollowUp: 'They bring a deep understanding of both cultures and a passion for teaching. What would you like to do next?', typeQuestion: 'Type your question here...', send: 'Send', thinking: 'OKay Thai Bot is thinking...', apiError: "I'm sorry, I couldn't generate a response right now. Please try again.", connectionError: "I seem to be having trouble connecting. Please check your connection and try again.", anythingElse: 'Is there anything else I can help you with?', askAnother: 'Ask Another Question ✨', findLevel: 'Help Me Find My Level 🧠', levelTestIntro: 'Great! I will ask you 3 questions to help determine the best starting level for you. Let\'s begin!', levelTestResult: 'Thank you! Based on your answers, here is my recommendation:', levelRecommendation: (level) => `It looks like you have a good grasp of the basics! I recommend starting with our **Normal Class - ${level}** to build on your existing knowledge.`, levelCompleteBeginner: 'It looks like you\'re just starting your journey, which is exciting! I recommend our **Normal Class - Basic** course.', viewCourse: 'View This Course', conversationPractice: 'Conversation Practice 💬', culturalCompass: 'Cultural Compass 🧭', practiceIntro: 'Let\'s practice! Choose a real-world scenario:', practiceScenario1: 'Ordering Coffee', practiceScenario2: 'Bargaining at a Market', practiceSoon: 'Excellent choice! The full, interactive role-playing feature is a premium tool for enrolled students. Here\'s a preview of how it would start:', practiceExample: 'The barista smiles and asks: \'สวัสดีครับ รับอะไรดีครับ\' (Sawasdee krap, rap arai dee krap?) - \'Hello, what can I get for you?\'', culturalIntro: 'I can certainly help with that. What deep cultural question do you have about Thailand?', howToReply: 'How should I reply?', replySuggestion: 'A good reply would be: "เอาคาปูชิโน่ร้อนค่ะ" (Ao cappuccino rawn ka) - "I\'ll have a hot cappuccino, please."', nameLabel: 'Name', priceLabel: 'Price', durationLabel: 'Duration', methodLabel: 'Method', qualificationLabel: 'Qualification', workLabel: 'Work', teachingLabel: 'Teaching' },
            mm: { welcome: 'မင်္ဂလာပါ။ OKay Thai Language Center မှ ကြိုဆိုပါတယ်။ ကျွန်တော်က AI Concierge ပါ။ ဒီနေ့ ဘာအကူအညီပေးရမလဲခင်ဗျာ။', findCourse: 'သင်တန်းရှာရန်', askQuestion: 'မေးခွန်းမေးရန်', meetLecturers: 'ဆရာ/ဆရာမများနှင့် တွေ့ဆုံရန်', goBack: 'နောက်သို့ပြန်သွားရန်', coursePrompt: 'ကျွန်တော်ကူညီနိုင်ပါတယ်။ သင့်အတွက်အကောင်းဆုံးသင်တန်းကိုအကြံပြုနိုင်ရန် ဘယ်လိုသင်တန်းအမျိုးအစားကို စိတ်ဝင်စားပါသလဲ။', levelPrompt: (type) => `${type} အတွက် ဘယ်အဆင့်ကို စိတ်ဝင်စားပါသလဲ။`, courseResultHeader: 'သင်၏ အကြံပြုသင်တန်း', enrollPrompt: 'ဤသင်တန်းအတွက် စာရင်းသွင်းရန် လမ်းညွှန်ပေးနိုင်သည် သို့မဟုတ် အခြားရွေးချယ်စရာများကို ရှာဖွေနိုင်ပါသည်။ ဘာလုပ်ချင်ပါသလဲ။', enrollNow: 'ယခုစာရင်းသွင်းပါ။ ✨', exploreOther: 'အခြားသင်တန်းများရှာဖွေရန်', mainMenu: 'ပင်မမီနူး', enrollSoon: 'ဤစာရင်းသွင်းခြင်းအင်္ဂါရပ်သည် မကြာမီလာမည်။ လောလောဆယ်တွင် ကျွန်ုပ်တို့၏ဝန်ထမ်းများက သင့်စာရင်းသွင်းခြင်းကို အပြီးသတ်ရန် Facebook Messenger မှတစ်ဆင့် ဆက်သွယ်ပါမည်။ ကျေးဇူးတင်ပါသည်။', startOver: 'အစကနေပြန်စရန်', faqPrompt: 'အမေးများသောမေးခွန်းများအတွက် အဖြေများရှိပါသည်။ ဘယ်အကြောင်းအရာကို ကူညီရမလဲ။', faqFollowUp: 'အခြားအကြောင်းအရာတစ်ခုခုကို ကူညီနိုင်ပါသေးသလား။', seeOtherQuestions: 'အခြားမေးခွန်းများကြည့်ရန်', lecturerIntro: 'ဤသည်မှာ ကျွန်ုပ်တို့၏ အရည်အချင်းပြည့်မီပြီး အတွေ့အကြုံရှိသော ဆရာ/ဆရာမအချို့ဖြစ်ပါသည်။', lecturerFollowUp: 'သူတို့သည် ယဉ်ကျေးမှုနှစ်ခုလုံးကို နက်နက်နဲနဲနားလည်ပြီး သင်ကြားရေးကို စိတ်အားထက်သန်ကြသည်။ နောက်ဘာလုပ်ချင်ပါသလဲ။', typeQuestion: 'သင့်မေးခွန်းကို ဤနေရာတွင် ရိုက်ထည့်ပါ...', send: 'ပို့ရန်', thinking: 'OKay Thai Bot စဉ်းစားနေသည်...', apiError: "တောင်းပန်ပါတယ်။ အခုလောလောဆယ် အဖြေမပေးနိုင်သေးပါဘူး။ ကျေးဇူးပြု၍ နောက်တစ်ကြိမ်ထပ်ကြိုးစားပါ။", connectionError: "ချိတ်ဆက်ရာတွင် အခက်အခဲရှိနေပုံရသည်။ ကျေးဇူးပြု၍ သင်၏ချိတ်ဆက်မှုကိုစစ်ဆေးပြီး နောက်တစ်ကြိမ်ထပ်ကြိုးစားပါ။", anythingElse: 'နောက်ထပ်ဘာများကူညီပေးရမလဲခင်ဗျာ။', askAnother: 'နောက်ထပ်မေးခွန်းတစ်ခုမေးရန် ✨', findLevel: 'ကျွန်ုပ်၏အဆင့်ကိုရှာဖွေရန်ကူညီပါ 🧠', levelTestIntro: 'ကောင်းပါပြီ! သင့်အတွက် အကောင်းဆုံးအစပြုအဆင့်ကို ဆုံးဖြတ်ရန် မေးခွန်း ၃ ခု မေးပါမည်။ စလိုက်ကြရအောင်။', levelTestResult: 'ကျေးဇူးတင်ပါတယ်! သင်၏အဖြေများပေါ်မူတည်၍ ဤသည်မှာ ကျွန်ုပ်၏အကြံပြုချက်ဖြစ်ပါသည်။', levelRecommendation: (level) => `သင်ဟာ အခြေခံတွေကို ကောင်းကောင်းနားလည်ထားပုံရပါတယ်! သင့်ရဲ့ရှိပြီးသားအသိပညာကို တည်ဆောက်ဖို့ ကျွန်ုပ်တို့ရဲ့ **Normal Class - ${level}** နဲ့ စတင်ဖို့ အကြံပြုလိုပါတယ်။`, levelCompleteBeginner: 'သင်ဟာ ခရီးတစ်ခုကို အခုမှစတင်နေတာဖြစ်ပြီး ဒါက စိတ်လှုပ်ရှားစရာကောင်းပါတယ်! ကျွန်ုပ်တို့ရဲ့ **Normal Class - Basic** သင်တန်းကို အကြံပြုလိုပါတယ်။', viewCourse: 'ဤသင်တန်းကိုကြည့်ရန်', conversationPractice: 'စကားပြောလေ့ကျင့်ခန်း 💬', culturalCompass: 'ယဉ်ကျေးမှုဆိုင်ရာမေးခွန်း 🧭', practiceIntro: 'လေ့ကျင့်ကြရအောင်။ လက်တွေ့ဘဝအခြေအနေတစ်ခုကို ရွေးချယ်ပါ။', practiceScenario1: 'ကော်ဖီမှာယူခြင်း', practiceScenario2: 'ဈေးတွင်ဈေးဆစ်ခြင်း', practiceSoon: 'ဒါက ရွေးချယ်မှုကောင်းတစ်ခုပါ။ စာရင်းသွင်းပြီးနောက် ပรีမီယံကျောင်းသားအတွေ့အကြုံ၏ တစ်စိတ်တစ်ပိုင်းအဖြစ် အပြန်အလှန်အကျိုးသက်ရောက်မှုရှိသော အခန်းကဏ္ဍသရုပ်ဆောင်ခြင်းအင်္ဂါရပ်အပြည့်အစုံကို ရရှိနိုင်မှာဖြစ်ပါတယ်။ ၎င်းသည် ဤသို့စတင်မည်ဖြစ်သည်...', practiceExample: 'ကော်ဖီဆိုင်ဝန်ထမ်းက ပြုံးပြီးမေးသည်: \'สวัสดีครับ รับอะไรดีครับ\' (Sawasdee krap, rap arai dee krap?) - \'မင်္ဂလာပါ၊ ဘာယူမလဲครับ?\'', culturalIntro: 'ကူညီနိုင်ပါတယ်။ ထိုင်းယဉ်ကျေးမှုနဲ့ပတ်သက်ပြီး ဘယ်လိုနက်နဲတဲ့မေးခွန်းမျိုး သိချင်ပါသလဲ။', howToReply: 'ဘယ်လိုပြန်ဖြေရမလဲ။', replySuggestion: 'ကောင်းသောပြန်စာတစ်ခုမှာ "เอาคาปูชิโน่ร้อนค่ะ" (Ao cappuccino rawn ka) - "ကော်ဖီပူပူတစ်ခွက်ကျေးဇူးပြု၍" ဖြစ်သည်။', nameLabel: 'အမည်', priceLabel: 'စျေးနှုန်း', durationLabel: 'ကြာချိန်', methodLabel: 'သင်ကြားနည်း', qualificationLabel: 'အရည်အချင်း', workLabel: 'အလုပ်', teachingLabel: 'သင်ကြားမှု' },
            th: { welcome: 'สวัสดีค่ะ! ยินดีต้อนรับสู่ OKay Thai Language Center ดิฉันคือ AI Concierge ค่ะ วันนี้มีอะไรให้ช่วยคะ', findCourse: 'ค้นหาคอร์สของคุณ', askQuestion: 'ถามคำถาม', meetLecturers: 'พบกับอาจารย์', goBack: 'กลับไป', coursePrompt: 'ช่วยได้แน่นอนค่ะ! เพื่อแนะนำคอร์สที่สมบูรณ์แบบที่สุด ไม่ทราบว่าสนใจคลาสประเภทไหนคะ', levelPrompt: (type) => `ยอดเยี่ยมค่ะ! สำหรับ ${type} สนใจระดับไหนคะ`, courseResultHeader: 'คอร์สแนะนำของคุณ', enrollPrompt: 'สามารถแนะนำขั้นตอนการลงทะเบียนสำหรับคอร์สนี้ หรือจะดูตัวเลือกอื่นๆ ก่อนก็ได้ค่ะ ต้องการทำอะไรต่อคะ', enrollNow: 'ลงทะเบียนเลย! ✨', exploreOther: 'ดูคอร์สอื่นๆ', mainMenu: 'เมนูหลัก', enrollSoon: 'ฟีเจอร์การลงทะเบียนเต็มรูปแบบกำลังจะมาในเร็วๆ นี้ค่ะ สำหรับตอนนี้ เจ้าหน้าที่จะติดต่อคุณผ่าน Facebook Messenger เพื่อดำเนินการลงทะเบียนให้เสร็จสิ้น ขอบคุณที่ให้ความสนใจค่ะ!', startOver: 'เริ่มต้นใหม่', faqPrompt: 'มีคำตอบสำหรับคำถามที่พบบ่อยหลายข้อค่ะ ไม่ทราบว่าสนใจหัวข้อไหนคะ', faqFollowUp: 'มีหัวข้ออื่นให้ช่วยอีกไหมคะ', seeOtherQuestions: 'ดูคำถามอื่นๆ', lecturerIntro: 'นี่คือส่วนหนึ่งของอาจารย์ผู้ทรงคุณวุฒิและมีประสบการณ์ของเราค่ะ:', lecturerFollowUp: 'พวกเขามีความเข้าใจอย่างลึกซึ้งในทั้งสองวัฒนธรรมและความมุ่งมั่นในการสอนค่ะ ต้องการทำอะไรต่อคะ', typeQuestion: 'พิมพ์คำถามของคุณที่นี่...', send: 'ส่ง', thinking: 'OKay Thai Bot กำลังคิด...', apiError: "ขออภัยค่ะ ไม่สามารถสร้างคำตอบได้ในขณะนี้ กรุณาลองใหม่อีกครั้งค่ะ", connectionError: "ดูเหมือนว่าจะมีปัญหาในการเชื่อมต่อ กรุณาตรวจสอบการเชื่อมต่อของคุณแล้วลองใหม่อีกครั้งค่ะ", anythingElse: 'มีอะไรให้ช่วยอีกไหมคะ', askAnother: 'ถามคำถามอื่น ✨', findLevel: 'ช่วยฉันหาระดับของฉัน 🧠', levelTestIntro: 'เยี่ยมมากค่ะ! ดิฉันจะถามคำถาม 3 ข้อเพื่อช่วยหาระดับเริ่มต้นที่ดีที่สุดสำหรับคุณ มาเริ่มกันเลยค่ะ!', levelTestResult: 'ขอบคุณค่ะ! จากคำตอบของคุณ นี่คือคำแนะนำของดิฉันค่ะ:', levelRecommendation: (level) => `ดูเหมือนว่าคุณมีความเข้าใจพื้นฐานเป็นอย่างดี! ขอแนะนำให้เริ่มต้นด้วย **Normal Class - ${level}** ของเราเพื่อต่อยอดจากความรู้ที่มีอยู่ค่ะ`, levelCompleteBeginner: 'ดูเหมือนว่าคุณเพิ่งเริ่มต้นการเดินทางซึ่งน่าตื่นเต้นมากค่ะ! ขอแนะนำคอร์ส **Normal Class - Basic** ของเราค่ะ', viewCourse: 'ดูคอร์สนี้', conversationPractice: 'ฝึกสนทนา 💬', culturalCompass: 'เข็มทิศวัฒนธรรม 🧭', practiceIntro: 'มาฝึกกันเถอะ! เลือกสถานการณ์จริง:', practiceScenario1: 'สั่งกาแฟ', practiceScenario2: 'ต่อราคาที่ตลาด', practiceSoon: 'เป็นตัวเลือกที่ยอดเยี่ยมค่ะ! ฟีเจอร์การแสดงบทบาทสมมติแบบโต้ตอบเต็มรูปแบบเป็นส่วนหนึ่งของประสบการณ์นักเรียนพรีเมียมหลังจากการลงทะเบียนค่ะ มันจะเริ่มต้นแบบนี้...', practiceExample: 'บาริสต้ายิ้มและถามว่า: \'สวัสดีครับ รับอะไรดีครับ\' (Sawasdee krap, rap arai dee krap?)', culturalIntro: 'ช่วยได้ค่ะ มีคำถามเชิงลึกเกี่ยวกับวัฒนธรรมไทยอะไรที่อยากรู้คะ', howToReply: 'ฉันควรตอบอย่างไร?', replySuggestion: 'คำตอบที่ดีคือ "เอาคาปูชิโน่ร้อนค่ะ" (Ao cappuccino rawn ka) - "ขอกาแฟคาปูชิโน่ร้อนค่ะ"', nameLabel: 'ชื่อ', priceLabel: 'ราคา', durationLabel: 'ระยะเวลา', methodLabel: 'วิธีการสอน', qualificationLabel: 'คุณวุฒิ', workLabel: 'การทำงาน', teachingLabel: 'การสอน' }
        };

        function t(key, ...args) {
            const template = translations[currentLanguage][key] || translations['en'][key];
            return typeof template === 'function' ? template(...args) : template;
        }

        // --- SETTINGS AND THEME LOGIC ---
        function setLanguage(lang) {
            currentLanguage = lang;
            saveToStorage('okayThaiLang', lang);
            updateSettingsUI();
            chatLog.innerHTML = '';
            startConversation();
        }

        function setTheme(theme) {
            currentTheme = theme;
            document.body.className = theme;
            saveToStorage('okayThaiTheme', theme);
            updateSettingsUI();
        }

        function updateSettingsUI() {
            document.querySelectorAll('#language-options .option-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === currentLanguage);
            });
            document.querySelectorAll('#theme-options .option-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.theme === currentTheme);
            });
        }

        function openPanel(panelId) { document.getElementById(panelId).style.display = 'flex'; }
        function closePanel(panelId) { document.getElementById(panelId).style.display = 'none'; }
        
        // --- CORE CHAT LOGIC ---
        function appendMessage(sender, content, isLoading = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            const avatar = sender === 'ai' ? '🤖' : '👤';
            if (isLoading) messageDiv.id = 'loading-message';
            messageDiv.innerHTML = `<div class="avatar">${avatar}</div><div class="message-content">${content}</div>`;
            chatLog.appendChild(messageDiv);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        function removeLoadingMessage() {
            const loadingMsg = document.getElementById('loading-message');
            if (loadingMsg) loadingMsg.remove();
        }

        function clearInputArea() { userInputArea.innerHTML = ''; }

        function addButton(translationKey, action, ...args) {
            const button = document.createElement('button');
            button.className = 'action-button';
            const buttonText = t(translationKey, ...args);
            button.textContent = buttonText;
            button.onclick = () => {
                if(buttonText) appendMessage('user', buttonText);
                action();
            };
            userInputArea.appendChild(button);
        }

        // --- GEMINI API INTEGRATION ---
        async function callGeminiAPI(prompt) {
            appendMessage('ai', t('thinking'), true);
            clearInputArea();
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) throw new Error(`API call failed: ${response.status}`);
                const result = await response.json();
                removeLoadingMessage();
                return result.candidates?.[0]?.content?.parts?.[0]?.text || t('apiError');
            } catch (error) {
                console.error("Gemini API Error:", error);
                removeLoadingMessage();
                return t('connectionError');
            }
        }

        // --- CONVERSATION FLOW ---
        function startConversation() {
            clearInputArea();
            appendMessage('ai', t('welcome'));
            addButton('findCourse', showCourseOptions);
            addButton('findLevel', startLevelTest);
            addButton('conversationPractice', startConversationPractice);
            addButton('culturalCompass', startCulturalCompass);
        }
        
        function showCourseOptions() {
            clearInputArea();
            appendMessage('ai', t('coursePrompt'));
            Object.keys(data.courses).forEach(classType => {
                const button = document.createElement('button');
                button.className = 'action-button';
                button.textContent = classType;
                button.onclick = () => { appendMessage('user', classType); selectClassType(classType); };
                userInputArea.appendChild(button);
            });
            addButton('goBack', startConversation);
        }
        
        function selectClassType(classType) {
            conversationState.classType = classType;
            const levels = data.courses[classType];
            clearInputArea();
            if (levels.length === 1) {
                showCourseResult(levels[0]);
            } else {
                appendMessage('ai', t('levelPrompt', classType));
                levels.forEach(course => {
                    const button = document.createElement('button');
                    button.className = 'action-button';
                    button.textContent = course.level[currentLanguage];
                    button.onclick = () => { appendMessage('user', course.level[currentLanguage]); showCourseResult(course); };
                    userInputArea.appendChild(button);
                });
                addButton('goBack', showCourseOptions);
            }
        }
        
        function showCourseResult(course) {
            conversationState.selectedCourse = course;
            clearInputArea();
            const courseCard = `<div class="card"><h3>${t('courseResultHeader')}</h3><p><strong>${t('nameLabel')}:</strong> ${course.name[currentLanguage]}</p><p><strong>${t('priceLabel')}:</strong> ${course.price}</p><p><strong>${t('durationLabel')}:</strong> ${course.duration}</p><p><strong>${t('methodLabel')}:</strong> ${course.teaching[currentLanguage]}</p></div>`;
            appendMessage('ai', courseCard);
            appendMessage('ai', t('enrollPrompt'));
            addButton('enrollNow', enrollNow);
            addButton('exploreOther', showCourseOptions);
            addButton('mainMenu', startConversation);
        }
        
        async function enrollNow() {
            clearInputArea();
            const course = conversationState.selectedCourse;
            const prompt = `You are an AI Concierge for a Thai language school. A student is enrolling in "${course.name.en}". Generate a short, exciting, and personalized (2-3 sentences) welcome message for them in ${currentLanguage}, highlighting one fun aspect of their upcoming learning journey based on: "${course.teaching.en}".`;
            const personalizedMessage = await callGeminiAPI(prompt);
            appendMessage('ai', personalizedMessage.replace(/\n/g, '<br>'));
            appendMessage('ai', t('enrollSoon'));
            addButton('startOver', startConversation);
        }
        
        function showFaqOptions() {
            clearInputArea();
            appendMessage('ai', t('faqPrompt'));
            const faqTopics = [...new Set(data.faqs.map(f => f.category))];
            faqTopics.forEach(topic => {
                const button = document.createElement('button');
                button.className = 'action-button';
                button.textContent = topic;
                button.onclick = () => { appendMessage('user', topic); showFaqAnswer(topic); };
                userInputArea.appendChild(button);
            });
            addButton('goBack', startConversation);
        }

        function showFaqAnswer(topic) {
            clearInputArea();
            const relevantFaqs = data.faqs.filter(f => f.category === topic);
            let faqHtml = `Here are questions related to ${topic}:<br/><br/>`;
            relevantFaqs.forEach(faq => { faqHtml += `<strong>Q: ${faq.question[currentLanguage]}</strong><br/>A: ${faq.answer[currentLanguage]}<br/><br/>`; });
            appendMessage('ai', faqHtml);
            appendMessage('ai', t('faqFollowUp'));
            addButton('seeOtherQuestions', showFaqOptions);
            addButton('mainMenu', startConversation);
        }

        function showLecturers() {
            clearInputArea();
            let lecturerCards = `${t('lecturerIntro')}<br/><br/><div id="lecturer-list" style="max-height: 300px; overflow-y: auto; padding-right: 10px;">`;
            data.lecturers.forEach(lecturer => {
                 lecturerCards += `<div class="card"><h3>${lecturer.name}</h3><p><strong>${t('qualificationLabel')}:</strong> ${lecturer.qualification[currentLanguage]}</p><p><strong>${t('workLabel')}:</strong> ${lecturer.workExperience[currentLanguage]}</p><p><strong>${t('teachingLabel')}:</strong> ${lecturer.teachingExperience[currentLanguage]}</p></div>`;
            });
            lecturerCards += `</div>`;
            appendMessage('ai', lecturerCards);
            appendMessage('ai', t('lecturerFollowUp'));
            addButton('findCourse', showCourseOptions);
            addButton('mainMenu', startConversation);
        }
        
        // --- PLACEMENT TEST FLOW ---
        let testScore = 0;
        let questionNumber = 0;
        const totalQuestions = 3;
        
        function startLevelTest() {
            testScore = 0;
            questionNumber = 1;
            clearInputArea();
            appendMessage('ai', t('levelTestIntro'));
            askTestQuestion();
        }

        async function askTestQuestion() {
            const difficultyLevels = ['Beginner (A1)', 'Lower Intermediate (A2)', 'Intermediate (B1)'];
            const difficulty = difficultyLevels[questionNumber - 1];
            
            const prompt = `You are an AI Thai language tutor. Generate one unique, multiple-choice question to test a student's ${difficulty} level knowledge of Thai. The question should be about either vocabulary or simple grammar. Provide the question in English. Provide four possible answers in Thai script with English transliterations. Return ONLY a valid JSON object with the keys "question", "options" (an array of 4 strings), and "correctAnswer" (the index of the correct option, 0-3).`;
            
            const rawResponse = await callGeminiAPI(prompt);
            
            try {
                const jsonMatch = rawResponse.match(/\{[\s\S]*\}/);
                if (!jsonMatch) throw new Error("No JSON object found in the response.");
                
                const questionData = JSON.parse(jsonMatch[0]);
                let questionHtml = `<div class="card"><h3>Question ${questionNumber}/${totalQuestions}</h3><p>${questionData.question}</p></div>`;
                appendMessage('ai', questionHtml);
                clearInputArea();
                questionData.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'action-button';
                    button.textContent = option;
                    button.onclick = () => { appendMessage('user', option); checkTestAnswer(index, questionData.correctAnswer); };
                    userInputArea.appendChild(button);
                });
            } catch (error) {
                console.error("Failed to parse question JSON:", error, "Raw response:", rawResponse);
                appendMessage('ai', t('apiError'));
                addButton('mainMenu', startConversation);
            }
        }

        function checkTestAnswer(selectedIndex, correctIndex) {
            if (selectedIndex === correctIndex) testScore++;
            questionNumber++;
            if (questionNumber > totalQuestions) finishLevelTest();
            else askTestQuestion();
        }

        async function finishLevelTest() {
            clearInputArea();
            appendMessage('ai', t('levelTestResult'));
            let recommendation, recommendedCourse;
            if (testScore <= 1) {
                recommendation = t('levelCompleteBeginner');
                recommendedCourse = data.courses["Normal Class"].find(c => c.level.en === 'Basic');
            } else {
                const level = testScore === 2 ? 'Level 2' : 'Level 3';
                recommendation = t('levelRecommendation', level);
                recommendedCourse = data.courses["Normal Class"].find(c => c.level.en === level);
            }
            appendMessage('ai', recommendation);
            if (recommendedCourse) addButton('viewCourse', () => showCourseResult(recommendedCourse));
            addButton('mainMenu', startConversation);
        }

        // --- CONVERSATION & CULTURE FLOWS ---
        function startConversationPractice() {
            clearInputArea();
            appendMessage('ai', t('practiceIntro'));
            addButton('practiceScenario1', () => handleScenario('Ordering Coffee in Bangkok'));
            addButton('practiceScenario2', () => handleScenario('Bargaining at a market in Chiang Mai'));
            addButton('goBack', startConversation);
        }
        
        async function handleScenario(scenario) {
            clearInputArea();
            appendMessage('ai', t('practiceSoon'));
            
            const prompt = `You are a Thai local role-playing with a language student. The scenario is "${scenario}". Start the conversation by saying something a local would say in Thai. Provide the Thai script, an English transliteration, and a simple English translation. Return ONLY a valid JSON object with keys "thai_script", "transliteration", and "translation".`;

            const rawResponse = await callGeminiAPI(prompt);
            try {
                const jsonMatch = rawResponse.match(/\{[\s\S]*\}/);
                if (!jsonMatch) throw new Error("No JSON object found in the response.");

                const convoData = JSON.parse(jsonMatch[0]);
                const convoHtml = `<div class="card"><p><em>${convoData.thai_script}</em><br>(${convoData.transliteration})<br>"${convoData.translation}"</p></div>`;
                appendMessage('ai', convoHtml);
                addButton('howToReply', () => appendMessage('ai', `<div class="card"><p>${t('replySuggestion')}</p></div>`));
                addButton('mainMenu', startConversation);
            } catch (error) {
                console.error("Failed to parse scenario JSON:", error, "Raw response:", rawResponse);
                appendMessage('ai', t('apiError'));
                addButton('mainMenu', startConversation);
            }
        }

        function startCulturalCompass() {
            handleFreeformQuestion(t('culturalIntro'));
        }

        function handleFreeformQuestion(introMessage = t('freeformPrompt')) {
            clearInputArea();
            appendMessage('ai', introMessage);
            const inputContainer = document.createElement('div');
            inputContainer.id = 'freeform-input-container';
            inputContainer.style.display = 'flex';
            const textInput = document.createElement('input');
            textInput.type = 'text';
            textInput.id = 'freeform-input';
            textInput.placeholder = t('typeQuestion');
            textInput.onkeydown = (e) => { if (e.key === 'Enter') submitFreeformQuestion(); };
            const sendButton = document.createElement('button');
            sendButton.className = 'action-button';
            sendButton.textContent = t('send');
            sendButton.onclick = submitFreeformQuestion;
            inputContainer.appendChild(textInput);
            inputContainer.appendChild(sendButton);
            userInputArea.appendChild(inputContainer);
            textInput.focus();
        }

        async function submitFreeformQuestion() {
            const input = document.getElementById('freeform-input');
            const userQuestion = input.value.trim();
            if (!userQuestion) return;
            appendMessage('user', userQuestion);
            const prompt = `You are a friendly and helpful AI Concierge for the "OKay Thai Language Center" and an expert on Thai culture. A user asked: "${userQuestion}". Answer the question in ${currentLanguage}. If the question is about the language center (courses, prices, lecturers), use the provided internal data. If the question is about Thai culture, festivals, food, or etiquette, use your general knowledge to provide a helpful and engaging answer. Internal Data: Courses: Normal, Children, Basic Speaking, Private classes online. Prices: Basic courses start at MMK 149,000. Lecturers: All are experienced Myanmar nationals. Location: All classes are online.`;
            const aiResponse = await callGeminiAPI(prompt);
            appendMessage('ai', aiResponse.replace(/\n/g, '<br>'));
            appendMessage('ai', t('anythingElse'));
            addButton('askAnother', () => handleFreeformQuestion());
            addButton('mainMenu', startConversation);
        }

        // --- DATA STORE ---
        const data = {
            courses: { 
                "Normal Class": [
                    { id: 'normal-basic', name: {en: 'Normal Class - Basic', mm: 'သာမန်တန်း - အခြေခံ', th: 'คลาสปกติ - พื้นฐาน'}, level: {en: 'Basic', mm: 'အခြေခံ', th: 'พื้นฐาน'}, duration: '2 months', price: 'MMK 149,000', teaching: {en: 'Comprehensive online lessons focusing on foundational Thai grammar and vocabulary.', mm: 'အခြေခံထိုင်းသဒ္ဒါနှင့် ဝေါဟာရကို အဓိကထားသော ပြည့်စုံသောအွန်လိုင်းသင်ခန်းစာများ။', th: 'บทเรียนออนไลน์ที่ครอบคลุมเน้นไวยากรณ์และคำศัพท์ภาษาไทยพื้นฐาน'} }, 
                    { id: 'normal-level2', name: {en: 'Normal Class - Level 2', mm: 'သာမန်တန်း - အဆင့် ၂', th: 'คลาสปกติ - ระดับ 2'}, level: {en: 'Level 2', mm: 'အဆင့် ၂', th: 'ระดับ 2'}, duration: '2 months', price: 'MMK 200,000', teaching: {en: 'Expands grammar, vocabulary, and practical conversations for daily life.', mm: 'နေ့စဉ်ဘဝအတွက် သဒ္ဒါ၊ ဝေါဟာရနှင့် လက်တွေ့စကားပြောစွမ်းရည်များ တိုးချဲ့သင်ကြားခြင်း။', th: 'ขยายไวยากรณ์ คำศัพท์ และการสนทนาเชิงปฏิบัติสำหรับชีวิตประจำวัน'} },
                    { id: 'normal-level3', name: {en: 'Normal Class - Level 3', mm: 'သာမန်တန်း - အဆင့် ၃', th: 'คลาสปกติ - ระดับ 3'}, level: {en: 'Level 3', mm: 'အဆင့် ၃', th: 'ระดับ 3'}, duration: '3 months', price: 'MMK 300,000', teaching: {en: 'Advanced grammar, situational dialogues, and deeper cultural nuances.', mm: 'အဆင့်မြင့်သဒ္ဒါ၊ အခြေအနေအလိုက်စကားပြောဆိုမှုများနှင့် ယဉ်ကျေးမှုဆိုင်ရာ နက်နဲမှုများ။', th: 'ไวยากรณ์ขั้นสูง บทสนทนาตามสถานการณ์ และความแตกต่างทางวัฒนธรรมที่ลึกซึ้งยิ่งขึ้น'} }
                ], 
                "Children Class": [
                    { id: 'children-basic', name: {en: 'Children Class - Basic', mm: 'ကလေးတန်း - အခြေခံ', th: 'คลาสเด็ก - พื้นฐาน'}, level: {en: 'Basic', mm: 'အခြေခံ', th: 'พื้นฐาน'}, duration: '2 months', price: 'MMK 149,000', teaching: {en: 'Fun and interactive lessons designed for young learners.', mm: 'ပျော်စရာကောင်းပြီး အပြန်အလှန်တုံ့ပြန်မှုရှိသော သင်ခန်းစာများ။', th: 'บทเรียนที่สนุกสนานและโต้ตอบได้ซึ่งออกแบบมาสำหรับผู้เรียนรุ่นเยาว์'} },
                    { id: 'children-level2', name: {en: 'Children Class - Level 2', mm: 'ကလေးတန်း - အဆင့် ၂', th: 'คลาสเด็ก - ระดับ 2'}, level: {en: 'Level 2', mm: 'အဆင့် ၂', th: 'ระดับ 2'}, duration: '2 months', price: 'MMK 200,000', teaching: {en: 'Engaging activities to expand vocabulary and simple sentence structures.', mm: 'ဝေါဟာရနှင့် ရိုးရှင်းသောဝါကျတည်ဆောက်ပုံများကို တိုးချဲ့ရန်အတွက် ဆွဲဆောင်မှုရှိသော လှုပ်ရှားမှုများ။', th: 'กิจกรรมที่มีส่วนร่วมเพื่อขยายคำศัพท์และโครงสร้างประโยคง่ายๆ'} }
                ], 
                "Basic Speaking Class": [
                    { id: 'basic-speaking', name: {en: 'Basic Speaking Class', mm: 'အခြေခံစကားပြောတန်း', th: 'คลาสพูดพื้นฐาน'}, level: {en: 'N/A', mm: 'N/A', th: 'N/A'}, duration: '2 months', price: 'MMK 149,000', teaching: {en: 'Intensive focus on everyday conversational Thai and practical phrases.', mm: 'နေ့စဉ်သုံး ထိုင်းစကားပြောနှင့် လက်တွေ့အသုံးဝင်သော စကားစုများကို အထူးအာရုံစိုက်ခြင်း။', th: 'เน้นการสนทนาภาษาไทยในชีวิตประจำวันและวลีที่ใช้ได้จริง'} }
                ], 
                "Private Class": [
                    { id: 'private', name: {en: 'Private Class (Customized)', mm: 'သီးသန့်သင်တန်း (စိတ်ကြိုက်)', th: 'คลาสส่วนตัว (กำหนดเอง)'}, level: {en: 'N/A', mm: 'N/A', th: 'N/A'}, duration: 'Varies', price: 'Varies', teaching: {en: 'Personalized 1-on-1 sessions tailored to your specific goals and schedule.', mm: 'သင်၏ သီးခြားပန်းတိုင်များနှင့် အချိန်ဇယားအတိုင်း စိတ်ကြိုက်ပြုလုပ်ထားသော တစ်ဦးချင်းသင်ခန်းစာများ။', th: 'เซสชันแบบตัวต่อตัวที่ปรับให้เหมาะกับเป้าหมายและตารางเวลาเฉพาะของคุณ'} }
                ] 
            },
            faqs: [
                { category: 'Classes', question: {en: 'What types of classes do you offer?', mm: 'ဘယ်လိုသင်တန်းအမျိုးအစားတွေ ပေးပါသလဲ။', th: 'มีคลาสประเภทใดบ้าง'}, answer: {en: 'We offer Normal Class, Children Class, Basic Speaking Class, and Private Classes, all online.', mm: 'ကျွန်ုပ်တို့သည် သာမန်တန်း၊ ကလေးတန်း၊ အခြေခံစကားပြောတန်းနှင့် သီးသန့်သင်တန်းများကို အွန်လိုင်းမှ ပို့ချပေးပါသည်။', th: 'เรามีคลาสปกติ คลาสเด็ก คลาสพูดพื้นฐาน และคลาสส่วนตัว ทั้งหมดออนไลน์ค่ะ'} }, 
                { category: 'Classes', question: {en: 'Do you offer in-person classes?', mm: 'လူကိုယ်တိုင်သင်တန်းများ ရှိပါသလား။', th: 'มีคลาสเรียนแบบตัวต่อตัวไหม'}, answer: {en: 'No, currently all our classes are conducted online for maximum flexibility.', mm: 'မရှိပါ။ လက်ရှိတွင် ကျွန်ုပ်တို့၏သင်တန်းအားလုံးကို အွန်လိုင်းမှသာ ပို့ချပေးပါသည်။', th: 'ไม่มีค่ะ ปัจจุบันคลาสทั้งหมดของเราสอนออนไลน์เพื่อความยืดหยุ่นสูงสุดค่ะ'} }, 
                { category: 'Pricing', question: {en: 'How much does a Basic class cost?', mm: 'အခြေခံသင်တန်းက ဘယ်လောက်ကျပါသလဲ။', th: 'คลาสพื้นฐานราคาเท่าไหร่'}, answer: {en: 'Our Basic level classes start at MMK 149,000 for 2 months.', mm: 'ကျွန်ုပ်တို့၏ အခြေခံအဆင့်သင်တန်းများသည် ၂ လအတွက် MMK 149,000 မှ စတင်ပါသည်။', th: 'คลาสระดับพื้นฐานของเราเริ่มต้นที่ 149,000 จ๊าดเป็นเวลา 2 เดือนค่ะ'} }, 
                { category: 'Pricing', question: {en: 'What payment methods do you accept?', mm: 'ဘယ်လိုငွေပေးချေမှုနည်းလမ်းတွေ လက်ခံပါသလဲ။', th: 'รับชำระเงินช่องทางใดบ้าง'}, answer: {en: 'We accept various online payment methods, including local bank transfers. Details are provided during registration.', mm: 'ကျွန်ုပ်တို့သည် ဘဏ်မှငွေလွှဲခြင်းအပါအဝင် အွန်လိုင်းငွေပေးချေမှုနည်းလမ်းအမျိုးမျိုးကို လက်ခံပါသည်။ အသေးစိတ်ကို စာရင်းသွင်းသည့်အခါ ပေးပါမည်။', th: 'เรารับชำระเงินออนไลน์หลายช่องทาง รวมถึงการโอนเงินผ่านธนาคารในประเทศ รายละเอียดจะแจ้งให้ทราบระหว่างการลงทะเบียนค่ะ'} }, 
                { category: 'Lecturers', question: {en: 'Are your lecturers from Myanmar or Thailand?', mm: 'သင်၏ဆရာ/ဆရာမများသည် မြန်မာ သို့မဟုတ် ထိုင်းနိုင်ငံမှလား။', th: 'อาจารย์ของคุณมาจากพม่าหรือไทย'}, answer: {en: 'Our dedicated lecturers are all experienced Myanmar nationals, residing in both Myanmar and Thailand, offering a unique and culturally rich learning experience.', mm: 'ကျွန်ုပ်တို့၏ ဆရာ/ဆရာမများအားလုံးသည် မြန်မာနှင့်ထိုင်းနိုင်ငံတို့တွင် နေထိုင်ကြသော အတွေ့အကြုံရှိ မြန်မာနိုင်ငံသားများဖြစ်ကြပြီး ထူးခြားပြီး ယဉ်ကျေးမှုကြွယ်ဝသော သင်ယူမှုအတွေ့အကြုံကို ပေးပါသည်။', th: 'อาจารย์ที่ทุ่มเทของเราทุกคนเป็นชาวเมียนมาร์ที่มีประสบการณ์ อาศัยอยู่ในทั้งเมียนมาร์และไทย มอบประสบการณ์การเรียนรู้ที่ไม่เหมือนใครและเต็มไปด้วยวัฒนธรรมค่ะ'} }
            ],
            lecturers: [
                { name: "TR. ZAW", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "3 years working experiences in Thai Company", mm: "ထိုင်းကုမ္ပဏီတွင် ၃ နှစ်အလုပ်လုပ်ကိုင်ခဲ့သော အတွေ့အကြုံ", th: "ประสบการณ์การทำงาน 3 ปีในบริษัทไทย"}, teachingExperience: {en: "5 years teaching experiences", mm: "၅ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 5 ปี"} },
                { name: "TR. PHYU", qualification: {en: "B.A (Thai, YUFL)", mm: "B.A (Thai, YUFL)", th: "B.A (Thai, YUFL)"}, workExperience: {en: "Thai Translator and Interpreter in Toyota Company", mm: "Toyota ကုမ္ပဏီတွင် ထိုင်းဘာသာပြန်နှင့် စကားပြန်", th: "นักแปลและล่ามภาษาไทยในบริษัทโตโยต้า"}, teachingExperience: {en: "2 years teaching experiences", mm: "၂ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 2 ปี"} },
                { name: "TR. SHWE", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "Thai translator and interpreter in Golden Sea MyanmarCo.,Ltd", mm: "Golden Sea Myanmar Co.,Ltd တွင် ထိုင်းဘာသာပြန်နှင့် စကားပြန်", th: "นักแปลและล่ามภาษาไทยใน Golden Sea Myanmar Co.,Ltd"}, teachingExperience: {en: "2 years teaching experiences", mm: "၂ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 2 ปี"} },
                { name: "TR. MAY", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "3 years working experiences in Thai Company", mm: "ထိုင်းကုမ္ပဏီတွင် ၃ နှစ်အလုပ်လုပ်ကိုင်ခဲ့သော အတွေ့အကြုံ", th: "ประสบการณ์การทำงาน 3 ปีในบริษัทไทย"}, teachingExperience: {en: "2 years teaching experiences", mm: "၂ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 2 ปี"} },
                { name: "TR. HTOO", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "Freelance Thai Translator and Interpreter", mm: "အလွတ်တန်း ထိုင်းဘာသာပြန်နှင့် စကားပြန်", th: "นักแปลและล่ามภาษาไทยอิสระ"}, teachingExperience: {en: "2 years teaching experience", mm: "၂ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 2 ปี"} },
                { name: "TR. PHUE", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "Freelance Thai Translator and Interpreter", mm: "အလွတ်တန်း ထိုင်းဘာသာပြန်နှင့် စကားပြန်", th: "นักแปลและล่ามภาษาไทยอิสระ"}, teachingExperience: {en: "2 years teaching experiences", mm: "၂ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 2 ปี"} },
                { name: "TR. SAKAR", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "1 year working experience in Thai Company", mm: "ထိုင်းကုမ္ပဏီတွင် ၁ နှစ်အလုပ်လုပ်ကိုင်ခဲ့သော အတွေ့အကြုံ", th: "ประสบการณ์การทำงาน 1 ปีในบริษัทไทย"}, teachingExperience: {en: "1 year teaching experience", mm: "၁ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 1 ปี"} },
                { name: "TR. SEINN", qualification: {en: "B.A (Q,Thai, YUFL)", mm: "B.A (Q,Thai, YUFL)", th: "B.A (Q,Thai, YUFL)"}, workExperience: {en: "Freelance Thai Translator and Interpreter", mm: "အလွတ်တန်း ထိုင်းဘာသာပြန်နှင့် စကားပြန်", th: "นักแปลและล่ามภาษาไทยอิสระ"}, teachingExperience: {en: "3 years teaching experience", mm: "၃ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 3 ปี"} },
                { name: "TR. HSU", qualification: {en: "B.A (Thai, YUFL)", mm: "B.A (Thai, YUFL)", th: "B.A (Thai, YUFL)"}, workExperience: {en: "Thai Linguist 1 year", mm: "ထိုင်းဘာသာဗေဒပညာရှင် ၁ နှစ်", th: "นักภาษาศาสตร์ไทย 1 ปี"}, teachingExperience: {en: "5 years teaching experience", mm: "၅ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 5 ปี"} },
                { name: "TR. PHYU", qualification: {en: "B.A (Thai, YUFL)", mm: "B.A (Thai, YUFL)", th: "B.A (Thai, YUFL)"}, workExperience: {en: "Freelance Thai Translator and Interpreter", mm: "အလွတ်တန်း ထိုင်းဘာသာပြန်နှင့် စကားပြန်", th: "นักแปลและล่ามภาษาไทยอิสระ"}, teachingExperience: {en: "1 year teaching experience", mm: "၁ နှစ်သင်ကြားရေးအတွေ့အကြုံ", th: "ประสบการณ์การสอน 1 ปี"} }
            ]
        };

        // --- APP INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            currentLanguage = loadFromStorage('okayThaiLang', 'en');
            currentTheme = loadFromStorage('okayThaiTheme', 'theme-default');
            setTheme(currentTheme);
            updateSettingsUI();
            
            document.getElementById('langBtn').addEventListener('click', () => openPanel('language-panel'));
            document.getElementById('themeBtn').addEventListener('click', () => openPanel('theme-panel'));
            document.getElementById('closeLangBtn').addEventListener('click', () => closePanel('language-panel'));
            document.getElementById('closeThemeBtn').addEventListener('click', () => closePanel('theme-panel'));
            
            document.querySelectorAll('#language-options .option-btn').forEach(btn => {
                btn.addEventListener('click', () => setLanguage(btn.dataset.lang));
            });
            document.querySelectorAll('#theme-options .option-btn').forEach(btn => {
                btn.addEventListener('click', () => setTheme(btn.dataset.theme));
            });
            
            createStars();
            startConversation();
        });

    </script>
</body>
</html>
