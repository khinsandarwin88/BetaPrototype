<!-- Enhanced OKay Thai AI Concierge Web App -->
<!-- Includes full logic: multi-language support, theme selector, course selection, lecturer info, placement test, and Google Sheets integration -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OKay Thai - AI Concierge</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    :root {
      --bg-main: #19162c;
      --bg-alt: #3c2f5f;
      --text-color: #fffbe6;
      --accent: #fff200;
    }
    [data-theme="dark"] {
      --bg-main: #0d0d0d;
      --bg-alt: #1a1a1a;
      --text-color: #ffffff;
      --accent: #e60000;
    }
    [data-theme="colorblind"] {
      --bg-main: #222;
      --bg-alt: #444;
      --text-color: #f0f0f0;
      --accent: #ff8c00;
    }
    [data-theme="autism"] {
      --bg-main: #002244;
      --bg-alt: #003366;
      --text-color: #ffffff;
      --accent: #00ccff;
    }
    [data-theme="pride"] {
      --bg-main: #1a1a1a;
      --bg-alt: #333;
      --text-color: #fff;
      --accent: linear-gradient(to right, red, orange, yellow, green, blue, violet);
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(160deg, var(--bg-main), var(--bg-alt));
      color: var(--text-color);
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      text-align: center;
      padding: 2rem 1rem;
    }
    header h1 {
      font-size: 2.2rem;
      color: var(--accent);
    }
    .chat-container {
      background: rgba(25, 22, 44, 0.85);
      border-radius: 16px;
      box-shadow: 0 0 20px var(--accent);
      max-width: 800px;
      width: 100%;
      padding: 1rem;
      margin: 1rem;
    }
    .input-area, .lead-form, .settings-area {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 1rem;
      justify-content: center;
    }
    .action-button {
      padding: 0.75rem 1.25rem;
      background: var(--accent);
      border: none;
      border-radius: 12px;
      font-weight: 600;
      color: #19162c;
      cursor: pointer;
      box-shadow: 0 0 10px var(--accent);
      transition: transform 0.2s ease;
    }
    .action-button:hover {
      transform: scale(1.05);
    }
    input, select {
      padding: 0.5rem;
      border-radius: 8px;
      border: 1px solid var(--accent);
      flex: 1 1 45%;
    }
    .message {
      margin: 0.5rem 0;
    }
  </style>
</head>
<body>
  <header>
    <h1>OKay Thai AI Concierge</h1>
    <p id="greeting">Helping Myanmar Students Learn Thai ‚Äî Smarter</p>
  </header>

  <div class="settings-area">
    <select onchange="setLanguage(this.value)">
      <option value="en">English</option>
      <option value="mm">Myanmar</option>
      <option value="th">Thai</option>
    </select>
    <select onchange="setTheme(this.value)">
      <option value="default">Main Theme</option>
      <option value="dark">Dark Theme</option>
      <option value="colorblind">Color Blind</option>
      <option value="autism">Autism Friendly</option>
      <option value="pride">Pride Theme</option>
    </select>
  </div>

  <section class="chat-container">
    <div id="chat-log">
      <div class="message" id="welcome-msg"></div>
    </div>

    <div class="input-area">
      <button class="action-button" onclick="startTest()">üß† Placement Test</button>
      <button class="action-button" onclick="showLeadForm()">üìã Enroll Now</button>
      <button class="action-button" onclick="readText()">üîä Hear Thai Greeting</button>
      <button class="action-button" onclick="showCourseList()">üìö Browse Courses</button>
      <button class="action-button" onclick="showLecturers()">üë©‚Äçüè´ Meet Lecturers</button>
    </div>

    <form id="lead-form" class="lead-form" style="display:none;">
      <input type="text" id="name" placeholder="Your Name" required />
      <input type="text" id="contact" placeholder="Facebook/Telegram/Viber" required />
      <select id="interest">
        <option>Basic Thai</option>
        <option>Speaking Only</option>
        <option>Children Class</option>
        <option>Private 1:1</option>
      </select>
      <button type="submit" class="action-button">Submit Lead</button>
    </form>
  </section>

  <script>
  const chatLog = document.getElementById('chat-log');
  const welcomeMsg = document.getElementById('welcome-msg');

  const messages = {
    en: "ü§ñ Hello! I am your AI Concierge for OKay Thai. How can I assist you today?",
    mm: "ü§ñ ·Äô·ÄÑ·Ä∫·Äπ·ÄÇ·Äú·Ä¨·Äï·Ä´·Åã OKay Thai ·Äô·Äæ AI Concierge ·Äñ·Äº·ÄÖ·Ä∫·Äï·Ä´·Äê·Äö·Ä∫·Åã ·Äò·Ä¨·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ·Äú·Ä≠·ÄØ·Äï·Ä´·Äû·Äú·Ä≤·Åã",
    th: "ü§ñ ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞! ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ AI ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≤‡∏Å OKay Thai ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞?"
  };

  function setLanguage(lang) {
    localStorage.setItem('lang', lang);
    welcomeMsg.innerText = messages[lang];
  }

  function setTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
  }

  window.onload = () => {
    const lang = localStorage.getItem('lang') || 'en';
    const theme = localStorage.getItem('theme') || 'default';
    setLanguage(lang);
    setTheme(theme);
  };

  function appendMessage(message, sender = 'ai') {
    const div = document.createElement('div');
    div.className = 'message';
    div.innerHTML = `${sender === 'ai' ? 'ü§ñ' : 'üë§'} ${marked.parseInline(message)}`;
    chatLog.appendChild(div);
    chatLog.scrollTop = chatLog.scrollHeight;
  }

  function showLeadForm() {
    document.getElementById('lead-form').style.display = 'flex';
  }

  function readText() {
    const synth = window.speechSynthesis;
    const utter = new SpeechSynthesisUtterance('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞');
    utter.lang = 'th-TH';
    synth.speak(utter);
  }

  function showCourseList() {
    appendMessage("We offer: 1. Thai Speaking Only, 2. 4-skills Thai Class, 3. One-on-One, 4. Children‚Äôs Group Class, 5. Private Group Class.");
  }

  function showLecturers() {
    appendMessage("üë©‚Äçüè´ TR. ZAW ‚Äî 5 years teaching experience.\nüë©‚Äçüè´ TR. PHYU ‚Äî Translator at Toyota, 2 years teaching.\nüë©‚Äçüè´ TR. MAY ‚Äî Fluent in Thai, 3 years in Thai Company.");
  }

  // Full Placement Test Logic
  const testQuestions = [
    {
      q: "What does \"‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ\" mean?",
      options: ["Goodbye", "Thank you", "Hello", "Please"],
      correct: 2
    },
    {
      q: "What is the Thai word for \"water\"?",
      options: ["‡∏Ç‡πâ‡∏≤‡∏ß", "‡∏ô‡πâ‡∏≥", "‡πÑ‡∏ü", "‡∏õ‡∏•‡∏≤"],
      correct: 1
    },
    {
      q: "Choose the Thai script for \"school\".",
      options: ["‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠"],
      correct: 2
    },
    {
      q: "Which tone is used in \"‡∏Ç‡∏≤‡∏ß\" (white)?",
      options: ["Mid", "Rising", "Falling", "Low"],
      correct: 1
    },
    {
      q: "Which Thai sentence means \"I like to learn Thai\"?",
      options: [
        "‡∏â‡∏±‡∏ô‡∏ä‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢",
        "‡∏ú‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢",
        "‡∏â‡∏±‡∏ô‡πÑ‡∏õ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",
        "‡∏ú‡∏°‡∏ä‡∏≠‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏ó‡∏¢"
      ],
      correct: 0
    }
  ];

  let currentQuestion = 0;
  let score = 0;

  function startTest() {
    currentQuestion = 0;
    score = 0;
    askQuestion();
  }

  function askQuestion() {
    const q = testQuestions[currentQuestion];
    let msg = `üß† Q${currentQuestion + 1}: ${q.q}`;
    q.options.forEach((opt, i) => {
      msg += `\n${String.fromCharCode(65 + i)}. ${opt}`;
    });
    appendMessage(msg);
    waitForAnswer();
  }

  function waitForAnswer() {
    document.addEventListener('keydown', handleKey);
  }

  function handleKey(e) {
    const key = e.key.toUpperCase();
    const validKeys = ['A', 'B', 'C', 'D'];
    if (!validKeys.includes(key)) return;
    document.removeEventListener('keydown', handleKey);

    const selected = validKeys.indexOf(key);
    const correct = testQuestions[currentQuestion].correct;

    if (selected === correct) {
      appendMessage("‚úÖ Correct!", 'ai');
      score++;
    } else {
      appendMessage(`‚ùå Incorrect. Correct answer is ${String.fromCharCode(65 + correct)}.`, 'ai');
    }

    currentQuestion++;
    if (currentQuestion < testQuestions.length) {
      setTimeout(askQuestion, 1000);
    } else {
      setTimeout(showResult, 1000);
    }
  }

  function showResult() {
    const level = score >= 4 ? 'Advanced' : score >= 2 ? 'Intermediate' : 'Beginner';
    appendMessage(`üéâ You scored ${score}/${testQuestions.length}. Recommended level: **${level}**.`);
    appendMessage(`üì• Would you like to enroll in a class? Click "Enroll Now" to get started.`);
  }

  document.getElementById('lead-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const name = document.getElementById('name').value;
    const contact = document.getElementById('contact').value;
    const interest = document.getElementById('interest').value;

    const payload = { name, contact, interest };

    fetch('https://script.google.com/macros/s/AKfycbxkX1OmhdUuwcrGgFRmX07FOl7CqeTF_HTJv__A1WmOeVVWde1Q7_zwd7FzPuTck1PQFQ/exec', {
      method: 'POST',
      body: JSON.stringify(payload),
      headers: { 'Content-Type': 'application/json' }
    })
    .then(res => res.json())
    .then(data => {
      appendMessage(`Thanks, ${name}! We saved your interest in ${interest}. Our team will contact you soon.`);
      document.getElementById('lead-form').reset();
      document.getElementById('lead-form').style.display = 'none';
    })
    .catch(err => {
      console.error('Error saving lead:', err);
      alert('There was a problem saving your lead. Try again.');
    });
  });
</script>
</body>
</html>